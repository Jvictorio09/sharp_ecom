{% extends "base.html" %}
{% block title %}Order Status — SHARP{% endblock %}
{% block content %}
<section class="py-12 md:py-20">
  <div class="max-w-3xl mx-auto px-4 md:px-0">
    <h1 class="text-2xl md:text-4xl font-extrabold mb-6">Track your order</h1>
    <p class="text-ink/70 mb-8">Enter your order number and (optionally) the email you used at checkout.</p>

    <form method="post" class="bg-white border border-line rounded-2xl p-6 space-y-4">{% csrf_token %}
      <div>
        <label class="text-sm font-medium">Order number</label>
        <input name="order_number" required placeholder="e.g. SH-482931"
               class="mt-1 w-full px-4 py-3 rounded-xl border border-line bg-white focus:outline-none focus:ring-2 focus:ring-[var(--sharp-gold)]">
      </div>
      <div>
        <label class="text-sm font-medium">Email (optional)</label>
        <input name="email" type="email" placeholder="you@example.com"
               class="mt-1 w-full px-4 py-3 rounded-xl border border-line bg-white focus:outline-none focus:ring-2 focus:ring-[var(--sharp-gold)]">
      </div>
      <button class="btn w-full px-6 py-3 rounded-full text-white bg-[var(--sharp-gold)] hover:bg-[var(--sharp-hunter)]">
        Check status
      </button>
    </form>

    {% if messages %}
      <div class="mt-6 space-y-3">
        {% for message in messages %}
          <div class="rounded-xl border border-line bg-white p-4">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}

    {% if order %}
      <div class="mt-8 rounded-2xl border border-line bg-ivory p-6">
        <div class="flex items-center justify-between gap-4">
          <div>
            <p class="text-xs uppercase tracking-widest text-ink/60">Order</p>
            <p class="text-lg font-semibold">{{ order.order_number }}</p>
          </div>
          <a href="{% url 'order_detail' order.order_number %}" class="btn px-5 py-2.5 rounded-full border border-line bg-white hover:border-[var(--sharp-gold)]">
            View details
          </a>
        </div>

        <div class="grid sm:grid-cols-2 gap-6 mt-6 text-sm">
          <div class="space-y-2">
            <p><span class="opacity-70">Placed:</span> {{ order.created_at|date:"M j, Y g:i a" }}</p>
            <p><span class="opacity-70">Status:</span> <span class="font-medium capitalize">{{ order.status }}</span></p>
            <p><span class="opacity-70">Total:</span> <span class="font-medium">₱{{ order.grand_total }}</span></p>
          </div>
          <div class="space-y-1">
            <p class="opacity-70">Shipping to</p>
            <p class="font-medium">{{ order.full_name }}</p>
            <p>{{ order.address_line1 }}{% if order.city %}, {{ order.city }}{% endif %}{% if order.province %}, {{ order.province }}{% endif %}{% if order.zip_code %}, {{ order.zip_code }}{% endif %}</p>
          </div>
        </div>

        <div class="mt-6">
          <p class="font-semibold mb-2">Items</p>
          <div class="divide-y divide-[var(--sharp-line)] bg-white border border-line rounded-xl">
            {% for it in order.items.all %}
              <div class="p-4 flex items-center justify-between">
                <span class="opacity-80">{{ it.name }} × {{ it.quantity }}</span>
                <span class="font-medium">₱{{ it.line_total }}</span>
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
    {% endif %}
  </div>
</section>
{% endblock %}
