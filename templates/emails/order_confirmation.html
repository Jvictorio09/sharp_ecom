<!doctype html>
<html lang="en">
  <body style="margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#f7f7f7;padding:24px">
    <table role="presentation" width="100%" cellspacing="0" cellpadding="0" style="max-width:640px;margin:auto;background:#fff;border:1px solid #eee;border-radius:12px;overflow:hidden">
      <tr>
        <td style="padding:24px 24px 8px">
          <h1 style="margin:0 0 8px;font-size:20px">Thanks for your order!</h1>
          <p style="margin:0;color:#555">Order <strong>{{ order.order_number }}</strong></p>
        </td>
      </tr>

      <!-- Items -->
      <tr>
        <td style="padding:0 24px 16px">
          <table role="presentation" width="100%" cellspacing="0" cellpadding="0" style="border-collapse:collapse">
            <tr>
              <th align="left"  style="padding:8px 0;color:#777;font-weight:600;border-bottom:1px solid #eee">Item</th>
              <th align="right" style="padding:8px 0;color:#777;font-weight:600;border-bottom:1px solid #eee">Total</th>
            </tr>
            {% with item_list=items|default:order.items.all %}
              {% for it in item_list %}
              <tr>
                <td style="padding:8px 0">{{ it.name }} × {{ it.quantity }}</td>
                <td align="right" style="padding:8px 0">JD{{ it.line_total|floatformat:2 }}</td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="2" style="padding:12px 0;color:#777">No items.</td>
              </tr>
              {% endfor %}
            {% endwith %}
          </table>
        </td>
      </tr>

      <!-- Totals -->
      <tr>
        <td style="padding:0 24px 8px">
          <table width="100%" cellpadding="0" cellspacing="0" role="presentation" style="border-collapse:collapse">
            <tr>
              <td style="padding:6px 0;color:#555">Subtotal</td>
              <td align="right" style="padding:6px 0;color:#111">JD{{ order.subtotal|floatformat:2 }}</td>
            </tr>
            <tr>
              <td style="padding:6px 0;color:#555">Shipping</td>
              <td align="right" style="padding:6px 0;color:#111">JD{{ order.shipping_cost|floatformat:2 }}</td>
            </tr>
            {% if order.discount_total and order.discount_total|stringformat:"f" != "0.00" %}
            <tr>
              <td style="padding:6px 0;color:#555">Discount</td>
              <td align="right" style="padding:6px 0;color:#111">-JD{{ order.discount_total|floatformat:2 }}</td>
            </tr>
            {% endif %}
            <tr>
              <td style="padding:10px 0;border-top:1px solid #eee;"><strong>Total</strong></td>
              <td align="right" style="padding:10px 0;border-top:1px solid #eee;"><strong>JD{{ order.grand_total|floatformat:2 }}</strong></td>
            </tr>
          </table>
        </td>
      </tr>

      <!-- Address + note -->
      <tr>
        <td style="padding:0 24px 24px;color:#555">
          <p style="margin:12px 0 0">
            Ship to: {{ order.full_name }}, {{ order.address_line1 }}{% if order.city %}, {{ order.city }}{% endif %}{% if order.province %}, {{ order.province }}{% endif %}{% if order.zip_code %}, {{ order.zip_code }}{% endif %}
          </p>
          <p style="margin:12px 0 0;font-size:13px;color:#777">
            If you don’t see this email, please check your <strong>Spam</strong> or <strong>Promotions</strong> tab and mark it as “Not spam”.
          </p>
        </td>
      </tr>
    </table>

    <p style="max-width:640px;margin:12px auto 0;color:#888;font-size:12px;text-align:center">
      Track your order anytime:
      <a href="{{ request.scheme }}://{{ request.get_host }}{% url 'order_status' %}" style="color:#111">Order Status</a>
    </p>
  </body>
</html>
